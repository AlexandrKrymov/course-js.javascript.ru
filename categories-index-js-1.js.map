{"version":3,"sources":["webpack:///./src/components/sortable-list/index.js","webpack:///./src/components/notification/index.js","webpack:///./src/components/categories/index.js","webpack:///./src/pages/categories/index.js"],"names":["SortableList","constructor","items","event","item","target","closest","preventDefault","handleGrab","handleDelete","this","dragstart","remove","dragend","setStyles","dragged","left","x","shiftX","top","y","shiftY","style","visibility","elementBellow","document","elementFromPoint","droppable","currentDroppable","coordY","getBoundingClientRect","moveDirection","getMoveDirection","pageY","element","nextSibling","insertPlaceholder","elements","render","addEventListeners","list","createElement","classList","add","map","getListItem","append","placeholder","getPlaceholder","elem","toHTML","addEventListener","onPointerDown","removeEventListeners","removeEventListener","props","prop","onPointerUp","draggedRect","clientX","clientY","draggedHeight","clientHeight","draggedWidth","clientWidth","width","height","onPointerMove","insertBefore","dispatchEvent","CustomEvent","oldY","newY","htmlString","htmlObject","innerHTML","firstElementChild","destroy","NotificationMessage","message","duration","type","setTimer","setTimeout","wrapper","template","show","body","currentNotification","clearTimeout","timer","Categories","toggle","async","category","categories","find","id","categoryId","querySelector","querySelectorAll","forEach","index","dataset","subcategories","weight","saveCategoryOrder","notyShow","url","URL","process","loadData","categoriesList","getCategoriesList","subElements","getSubElements","timeout","categoryItem","getTemplate","title","sortableList","getSubcategoriesList","push","onDragEnd","subcategoriesList","subcategory","getTemplateListItem","count","createSortableList","categoryName","name","subcategoryId","productCount","searchParams","set","response","fetch","toString","json","error","console","method","headers","JSON","stringify","onClickOpen","root","el","Page","initComponents","renderComponents","productId","components","component","Object","entries","replaceWith","values"],"mappings":"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","file":"categories-index-js-1.js","sourcesContent":["export default class SortableList {\n  onPointerDown = (event) => {\n    const item = event.target.closest('.sortable-list__item');\n    if (!item) return;\n    event.preventDefault();\n    const handleGrab = event.target.closest('[data-grab-handle]');\n    const handleDelete = event.target.closest('[data-delete-handle]');\n\n    if (handleGrab) {\n      this.dragstart(item, event);\n    } else if (handleDelete) {\n      item.remove();\n    }\n  }\n\n  onPointerUp = (event) => {\n    event.preventDefault();\n    this.dragend();\n  }\n\n  onPointerMove = (event) => {\n    event.preventDefault();\n    this.setStyles(this.dragged, {\n      left: `${event.x - this.shiftX}px`,\n      top: `${event.y - this.shiftY}px`,\n    });\n\n    this.dragged.style.visibility = 'hidden';\n    const elementBellow = document.elementFromPoint(event.x, event.y);\n    this.dragged.style.visibility = '';\n\n    // Если курсор вышел за пределы окна, то бросаем перетаскиваемый элемент\n    if (!elementBellow) {\n      this.dragend();\n      return;\n    }\n\n    // Элемент над которым находится курсор в данный момент перетаскивания\n    const droppable = elementBellow.closest('.sortable-list__item');\n\n    // Если в этот элемент нельзя сбросить, то завершаем функцию\n    if (!droppable || droppable === this.currentDroppable) {\n      this.currentDroppable = null;\n      return;\n    }\n\n    const coordY = droppable.getBoundingClientRect().top;\n\n    // Узнаем направление движения курсора\n    const moveDirection = this.getMoveDirection(this.pageY, event.pageY);\n    this.pageY = event.pageY;\n\n    // Если курсор зашел на элемент доступный для сбрасывания на него, то перемещаем плейсхолдер на его место\n    if (event.pageY > coordY) {\n      const element = (moveDirection === 'down') ? droppable.nextSibling : droppable;\n      this.insertPlaceholder(element);\n    }\n\n    this.currentDroppable = droppable;\n  }\n\n  constructor({items} = {}) {\n    this.elements = items;\n    this.render();\n    this.addEventListeners();\n  }\n\n  render() {\n    const list = document.createElement('ul');\n    list.classList.add('sortable-list');\n    const elements = this.elements.map((element) => this.getListItem(element));\n    list.append(...elements);\n    this.placeholder = this.getPlaceholder();\n    this.element = list;\n  }\n\n  getListItem(elem) {\n    const element = typeof elem === 'object' ? elem : this.toHTML(elem); // Добавил поддержку строк, а не только DOM элеиментов\n    element.classList.add('sortable-list__item');\n    return element;\n  }\n\n  getPlaceholder() {\n    const placeholder = document.createElement('div');\n    placeholder.classList.add('sortable-list__placeholder');\n    return placeholder;\n  }\n\n  addEventListeners() {\n    this.element.addEventListener('pointerdown', this.onPointerDown);\n  }\n\n  removeEventListeners() {\n    this.element.removeEventListener('pointerdown', this.onPointerDown);\n  }\n\n  setStyles(element, props) {\n    for (const prop in props) {\n      element.style[prop] = props[prop];\n    }\n  }\n\n  dragstart(dragged, event) {\n    this.dragged = dragged;\n    this.element.addEventListener('pointerup', this.onPointerUp);\n\n    const draggedRect = this.dragged.getBoundingClientRect();\n    this.shiftX = event.clientX - draggedRect.left;\n    this.shiftY = event.clientY - draggedRect.top;\n\n    this.draggedHeight = this.dragged.clientHeight;\n    this.draggedWidth = this.dragged.clientWidth;\n\n    this.setStyles(this.dragged, {\n      width: `${this.draggedWidth}px`,\n      left: `${event.x - this.shiftX}px`,\n      top: `${event.y - this.shiftY}px`,\n    });\n    this.setStyles(this.placeholder, {\n      height: `${this.draggedHeight}px`\n    });\n\n    this.insertPlaceholder(this.dragged);\n    this.dragged.classList.add('sortable-list__item_dragging');\n\n    this.element.addEventListener('pointermove', this.onPointerMove);\n  }\n\n  dragend() {\n    this.element.insertBefore(this.dragged, this.placeholder);\n    this.placeholder.remove();\n    this.setStyles(this.dragged, {\n      width: '',\n      left: '',\n      top: '',\n    });\n\n    this.dragged.classList.remove('sortable-list__item_dragging');\n    this.dragged = null;\n\n    this.element.removeEventListener('pointermove', this.onPointerMove);\n    this.element.removeEventListener('pointerup', this.onPointerUp);\n    this.element.dispatchEvent(new CustomEvent('dragend'));\n  }\n\n  getMoveDirection(oldY, newY) {\n    if (oldY < newY) {\n      return 'down';\n    } else if (oldY > newY) {\n      return 'up';\n    }\n  }\n\n  insertPlaceholder(element) {\n    this.element.insertBefore(this.placeholder, element);\n  }\n\n  toHTML(htmlString) {\n    const htmlObject = document.createElement('div');\n    htmlObject.innerHTML = htmlString;\n    return htmlObject.firstElementChild;\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n    this.removeEventListeners();\n  }\n\n  destroy() {\n    this.remove();\n  }\n}\n","export default class NotificationMessage {\n  constructor(message = '', {duration = 1000, type = 'success'} = {}) {\n    this.message = message;\n    this.duration = duration;\n    this.type = type;\n\n    this.render();\n  }\n\n  get template() {\n    return `\n      <div class=\"notification notification_${this.type} show\">\n        <div class=\"notification__content\"> ${this.message}</div>\n      </div>\n    `;\n  }\n\n  setTimer() {\n    setTimeout(() => {\n      this.destroy();\n    }, this.duration);\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = this.template;\n    this.element = wrapper.firstElementChild;\n  }\n\n  show(target = document.body) {\n    if (NotificationMessage.currentNotification) NotificationMessage.currentNotification.destroy();\n    target.append(this.element);\n    clearTimeout(NotificationMessage.timer);\n    NotificationMessage.timer = this.setTimer();\n    NotificationMessage.currentNotification = this;\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n  }\n\n  destroy() {\n    this.remove();\n    NotificationMessage.currentNotification = null;\n  }\n}\n","import SortableList from '~components/sortable-list/index.js';\nimport NotificationMessage from '~components/notification/index.js';\n\nexport default class Categories {\n  onClickOpen = event => {\n    if (!event.target.closest('.category__header')) return;\n    event.target.closest('.category').classList.toggle('category_open');\n  };\n\n  onDragEnd = async categoryId => {\n    const category = this.categories.find(category => category.id === categoryId);\n    const categoryBlock = document.querySelector(`[data-id=\"${categoryId}\"]`);\n    const subcategories = categoryBlock.querySelectorAll('.categories__sortable-list-item');\n    [...subcategories].forEach((element, index) => {\n      const id = element.dataset.id;\n      const subcategory = category.subcategories.find(item => item.id === id);\n      subcategory.weight = index + 1;\n    });\n    await this.saveCategoryOrder(category.subcategories);\n    this.notyShow('Позиции сохранены');\n  };\n\n  constructor() {\n    this.url = new URL('api/rest/categories', process.env.BACKEND_URL);\n  }\n\n  async render() {\n    this.categories = await this.loadData();\n\n    const categoriesList = this.toHTML('<div data-categories></div>');\n    categoriesList.append(...this.getCategoriesList(this.categories));\n    this.element = categoriesList;\n    this.subElements = this.getSubElements(this.element);\n    this.addEventListeners();\n\n    return this.element;\n  }\n\n  notyShow(message = '', type = 'success', timeout = 2000) {\n    const notification = new NotificationMessage(message, {\n      duration: timeout,\n      type\n    });\n    notification.show();\n  }\n\n  getCategoriesList(categories) {\n    const categoriesList = [];\n    for (const category of categories) {\n      const categoryItem = this.toHTML(this.getTemplate(category.title, category.id));\n      const sortableList = this.getSubcategoriesList(category.subcategories);\n      categoryItem.querySelector('.subcategory-list').append(sortableList);\n      categoriesList.push(categoryItem);\n      sortableList.addEventListener('dragend', () => this.onDragEnd(category.id));\n    }\n    return categoriesList;\n  }\n\n  getSubcategoriesList(subcategories) {\n    const subcategoriesList = subcategories.map(subcategory =>\n      this.toHTML(this.getTemplateListItem(subcategory.title, subcategory.id, subcategory.count))\n    );\n    return this.createSortableList(subcategoriesList);\n  }\n\n  getTemplate(categoryName, categoryId) {\n    return `\n        <div class=\"category category_open\" data-id=\"${categoryId}\">\n            <header class=\"category__header\">${categoryName}</header>\n            <div class=\"category__body\">\n                <div class=\"subcategory-list\"></div>\n            </div>\n        </div>\n        `;\n  }\n\n  getTemplateListItem(name, subcategoryId, productCount) {\n    return `\n        <li class=\"categories__sortable-list-item sortable-list__item\" data-grab-handle data-id=\"${subcategoryId}\">\n            <strong>${name}</strong>\n            <span><b>${productCount}</b> products</span>\n        </li>\n        `;\n  }\n\n  async loadData() {\n    this.url.searchParams.set('_sort', 'weight');\n    this.url.searchParams.set('_refs', 'subcategory');\n\n    try {\n      const response = await fetch(this.url.toString());\n      const data = await response.json();\n      return data;\n    } catch (error) {\n      console.error('Loading categories data error', error);\n    }\n  }\n\n  createSortableList(items) {\n    const sortableList = new SortableList({ items });\n    return sortableList.element;\n  }\n\n  async saveCategoryOrder(categories) {\n    const url = new URL('api/rest/subcategories', process.env.BACKEND_URL);\n    const response = await fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(categories)\n    });\n    const data = await response.json();\n  }\n\n  addEventListeners() {\n    this.element.addEventListener('pointerup', this.onClickOpen);\n  }\n\n  getSubElements(root) {\n    const subElements = {};\n    [...root.querySelectorAll('[data-element]')].forEach(el => {\n      subElements[el.dataset.element] = el;\n    });\n    return subElements;\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n  }\n\n  destroy() {\n    this.remove();\n    this.removeEventListeners();\n  }\n\n  toHTML(htmlString) {\n    const htmlObject = document.createElement('div');\n    htmlObject.innerHTML = htmlString;\n    return htmlObject.firstElementChild;\n  }\n}\n","import Categories from '~components/categories/index.js';\n\nexport default class Page {\n  conponents;\n\n  async render() {\n    await this.initComponents();\n    this.element = this.toHTML(this.getTemplate());\n    this.renderComponents();\n    this.subElements = this.getSubElements(this.element);\n    return this.element;\n  }\n\n  getTemplate() {\n    return `\n        <div class=\"categories\">\n            <div class=\"content__top-panel\">\n            <h1 class=\"page-title\">Категории товаров</h1>\n            </div>\n            <div data-element=\"categoriesContainer\">\n                <div data-categories></div>\n            </div>\n        </div>\n    `;\n  }\n\n  async initComponents() {\n    const categories = new Categories(this.productId);\n    await categories.render();\n\n    this.components = {\n        categories\n    };\n  }\n\n  renderComponents() {\n    for (const component of Object.entries(this.components)) {\n      this.element.querySelector(`[data-${component[0]}]`).replaceWith(component[1].element);\n    }\n  }\n\n  getSubElements(root) {\n    const subElements = {};\n    [...root.querySelectorAll('[data-element]')].forEach(el => {\n      subElements[el.dataset.element] = el;\n    });\n    return subElements;\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n  }\n\n  destroy() {\n    this.remove();\n    this.removeEventListeners();\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n\n  toHTML(htmlString) {\n    const htmlObject = document.createElement('div');\n    htmlObject.innerHTML = htmlString;\n    return htmlObject.firstElementChild;\n  }\n}\n"],"sourceRoot":""}