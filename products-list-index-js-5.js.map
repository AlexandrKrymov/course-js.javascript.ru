{"version":3,"sources":["webpack:///./src/components/sortable-table/index.js","webpack:///./src/components/double-slider/index.js","webpack:///./src/pages/products/list/products-header.js","webpack:///./src/pages/products/list/index.js"],"names":["SortableTable","constructor","headersConfig","data","url","sorted","id","find","el","sortable","order","isSortLocally","rowTemplate","content","async","element","event","target","closest","this","toggleOrder","dataset","append","subElements","arrow","sort","hasDataLoad","tableHeight","scrollHeight","offsetTop","document","documentElement","clientHeight","window","pageYOffset","isLoading","loadMore","end","string","arr","key","a","b","result","localeCompare","localeMatcher","caseFirst","number","date","Date","URL","render","table","toHTML","getTemplate","innerHtml","getSubElements","addEventListeners","getHeader","getBody","map","item","getHeaderCell","join","title","getArrow","getDefaultCellTemplate","value","getRows","dataItem","cells","template","getRow","field","sortOnClient","sortOnServer","body","classList","remove","innerHTML","length","add","sortType","forEach","sortFunctions","loadData","start","addLoader","searchParams","set","response","fetch","toString","json","removeLoader","error","console","htmlString","htmlObject","createElement","firstElementChild","asc","desc","root","querySelectorAll","header","addEventListener","onClick","onScroll","removeEventListeners","removeEventListener","offset","step","wrapper","children","destroy","DoubleSlider","min","max","formatValue","selected","from","to","preventDefault","left","innerLeft","right","innerRight","width","inner","getBoundingClientRect","dragging","thumbLeft","newLeft","clientX","shiftX","parseFloat","thumbRight","style","progress","getValue","newRight","onThumbPointerMove","onThumbPointerUp","dispatchEvent","CustomEvent","detail","bubbles","ondragstart","initEventListeners","update","onThumbPointerDown","elements","subElement","rangeTotal","Math","floor","thumbElem","round","Page","priceMin","priceMax","priceFrom","priceTo","updateSortableTable","Number","status","clearTimeout","timer","setTimeout","titleLike","filterStatus","filterName","updateRangeSlider","initComponents","renderComponents","rangeSlider","initRangeSlider","sortableTable","initSortableTable","components","price_gte","price_lte","productsUrl","process","RangeSlider","component","Object","entries","querySelector","replaceWith","onChangeRange","onChangeStatus","onInputTitle","onFilterReset","values"],"mappings":"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","file":"products-list-index-js-5.js","sourcesContent":["export default class SortableTable {\n  element;\n  hasDataLoad = true;\n\n  onClick = async event => {\n    const element = event.target.closest('[data-sortable=\"true\"]');\n    if (!element) return;\n    const order = this.toggleOrder(element.dataset.order);\n    element.dataset.order = order;\n    element.append(this.subElements.arrow);\n    await this.sort(element.dataset.id, order);\n    this.sorted.id = element.dataset.id;\n    this.sorted.order = order;\n  };\n  onScroll = () => {\n    if (!this.hasDataLoad) return;\n    const tableHeight = this.element.scrollHeight + this.element.offsetTop;\n    const scrollSize = document.documentElement.clientHeight + window.pageYOffset;\n    if (scrollSize >= tableHeight - 100 && !this.isLoading) {\n      this.loadMore();\n    }\n  };\n\n  isLoading = false;\n  start = 0;\n  end = 30;\n  step = 30;\n  offset = this.end;\n\n  constructor(\n    headersConfig,\n    {\n      data = [],\n      url = '',\n      sorted = {\n        id: headersConfig.find(el => el.sortable).id,\n        order: 'asc'\n      },\n      isSortLocally = false,\n      rowTemplate = (content) => `<div class=\"sortable-table__row\">${content}</div>`,\n    } = {}\n  ) {\n    this.headersConfig = headersConfig;\n    this.data = data;\n    this.url = new URL(url);\n    this.rowTemplate = rowTemplate;\n    this.sorted = sorted;\n    this.isSortLocally = isSortLocally;\n\n    this.render();\n  }\n\n  async render() {\n    const table = this.toHTML(this.getTemplate());\n\n    if (this.element) this.element.innerHtml = table.innerHtml;\n    else this.element = table;\n\n    this.subElements = this.getSubElements(this.element);\n    this.addEventListeners();\n\n    await this.sort(this.sorted.id, this.sorted.order);\n  }\n\n  getTemplate() {\n    return `\n      <div class=\"sortable-table\">\n        ${this.getHeader()}\n        ${this.getBody()}\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\n          <div>\n            <p>No products satisfies your filter criteria</p>\n            <button type=\"button\" class=\"button-primary-outline\" data-element=\"resetFilterBtn\">Reset all filters</button>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  getHeader() {\n    const headerCells = this.headersConfig.map(item => this.getHeaderCell(item));\n    return `\n      <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">${headerCells.join(\n        ''\n      )}</div>\n    `;\n  }\n\n  getHeaderCell({ id = '', title = '', sortable = false } = {}) {\n    const arrow = this.sorted.id === id ? this.getArrow() : '';\n    return `\n      <div class=\"sortable-table__cell\" id=\"${id}\" data-id=\"${id}\" data-sortable=\"${sortable}\" data-order=\"${this.sorted.order}\">\n        <span>${title}</span>\n        ${arrow}\n      </div>\n    `;\n  }\n\n  getDefaultCellTemplate(value) {\n    return `\n      <div class=\"sortable-table__cell\">${value}</div>\n    `;\n  }\n\n  getBody() {\n    return `<div data-element=\"body\" class=\"sortable-table__body\">${this.getRows().join('')}</div>`;\n  }\n\n  getRows(data = []) {\n    return data.map(dataItem => {\n      const cells = this.headersConfig.map(item => {\n        const value = dataItem[item.id];\n        const cell = item.template ? item.template(value) : this.getDefaultCellTemplate(value);\n        return cell;\n      });\n      return this.getRow(cells.join(''), dataItem);\n    });\n  }\n\n  getRow(cells, dataItem) {\n    return this.rowTemplate(cells, dataItem)\n    // if (this.rowLinkFrom) {\n    //   return `<a href=\"/products/3d-ochki-epson-elpgs03\" class=\"sortable-table__row\">${cells}</a>`;\n    // } else {\n    //   return `<div class=\"sortable-table__row\">${cells}</div>`;\n    // }\n  }\n\n  async sort(field = this.sorted.id, order = this.sorted.order) {\n    let data = this.isSortLocally\n      ? this.sortOnClient(field, order)\n      : await this.sortOnServer(field, order);\n    if (this.subElements && this.subElements.body) {\n      this.element.classList.remove('sortable-table_empty');\n      this.subElements.body.innerHTML = this.getRows(data).join('');\n    }\n    if(!data.length) this.element.classList.add('sortable-table_empty');\n  }\n\n  sortOnClient(id, order) {\n    let sortType = '';\n\n    this.headersConfig.forEach(el => {\n      if (el.id === id) {\n        el.order = order;\n        sortType = el.sortType;\n      } else {\n        el.order = false;\n      }\n    });\n\n    if (!sortType) return;\n\n    return this.sortFunctions[sortType](this.data, id, order);\n  }\n\n  sortFunctions = {\n    string: (arr, key, order = 'asc') => {\n      return arr.sort((a, b) => {\n        let result = a[key].localeCompare(b[key], ['ru-RU', 'es-US'], {\n          localeMatcher: 'lookup',\n          caseFirst: 'upper'\n        });\n        if (order === 'desc') result *= -1;\n        return result;\n      });\n    },\n    number: (arr, key, order = 'asc') => {\n      return arr.sort((a, b) => {\n        let result = a[key] - b[key];\n        if (order === 'desc') result *= -1;\n        return result;\n      });\n    },\n    date: (arr, key, order = 'asc') => {\n      return arr.sort((a, b) => {\n        let result = new Date(b[key]) - new Date(a[key]);\n        if (order === 'desc') result *= -1;\n        return result;\n      });\n    }\n  };\n\n  async sortOnServer(id, order) {\n    return await this.loadData(id, order);\n  }\n\n  async loadData(id, order, start = this.start, end = this.end) {\n    this.addLoader();\n\n    this.url.searchParams.set('_sort', id);\n    this.url.searchParams.set('_order', order);\n    this.url.searchParams.set('_start', start);\n    this.url.searchParams.set('_end', end);\n\n    try {\n      const response = await fetch(this.url.toString());\n      const data = await response.json();\n      this.removeLoader();\n      return data;\n    } catch (error) {\n      console.error('Loading data error in sortable table', error);\n    }\n  }\n\n  getArrow() {\n    return `\n      <span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\n        <span class=\"sort-arrow\"></span>\n      </span>\n    `;\n  }\n\n  toHTML(htmlString) {\n    const htmlObject = document.createElement('div');\n    htmlObject.innerHTML = htmlString;\n    return htmlObject.firstElementChild;\n  }\n\n  toggleOrder(order) {\n    const orders = {\n      asc: 'desc',\n      desc: 'asc'\n    };\n\n    return orders[order] || 'desc';\n  }\n\n  getSubElements(root) {\n    const subElements = {};\n    [...root.querySelectorAll('[data-element]')].forEach(el => {\n      subElements[el.dataset.element] = el;\n    });\n    return subElements;\n  }\n\n  addEventListeners() {\n    this.subElements.header.addEventListener('pointerdown', this.onClick);\n    document.addEventListener('scroll', this.onScroll);\n  }\n  removeEventListeners() {\n    this.subElements.header.removeEventListener('pointerdown', this.onClick);\n    document.removeEventListener('scroll', this.onScroll);\n  }\n\n  async loadMore() {\n    const start = this.offset;\n    const end = this.offset + this.step;\n    const data = await this.loadData(this.sorted.id, this.sorted.order, start, end);\n\n    if (data.length) {\n      const wrapper = document.createElement('div');\n      wrapper.innerHTML = this.getRows(data);\n      this.subElements.body.append(...wrapper.children);\n      this.offset = end;\n    } else {\n      this.hasDataLoad = false;\n    }\n  }\n\n  addLoader() {\n    this.isLoading = true;\n    this.element.classList.add('sortable-table_loading');\n  }\n\n  removeLoader() {\n    this.isLoading = false;\n    this.element.classList.remove('sortable-table_loading');\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n  }\n\n  destroy() {\n    this.remove();\n    this.removeEventListeners();\n  }\n}\n","export default class DoubleSlider {\n    element;\n    subElements = {};\n\n    onThumbPointerMove = event => {\n      event.preventDefault();\n\n      const { left: innerLeft, right: innerRight, width } = this.subElements.inner.getBoundingClientRect();\n\n      if (this.dragging === this.subElements.thumbLeft) {\n        let newLeft = (event.clientX - innerLeft + this.shiftX) / width;\n\n        if (newLeft < 0) {\n          newLeft = 0;\n        }\n        newLeft *= 100;\n        const right = parseFloat(this.subElements.thumbRight.style.right);\n\n        if (newLeft + right > 100) {\n          newLeft = 100 - right;\n        }\n\n        this.dragging.style.left = this.subElements.progress.style.left = newLeft + '%';\n        this.subElements.from.innerHTML = this.formatValue(this.getValue().from);\n      }\n\n      if (this.dragging === this.subElements.thumbRight) {\n        let newRight = (innerRight - event.clientX - this.shiftX) / width;\n\n        if (newRight < 0) {\n          newRight = 0;\n        }\n        newRight *= 100;\n\n        const left = parseFloat(this.subElements.thumbLeft.style.left);\n\n        if (left + newRight > 100) {\n          newRight = 100 - left;\n        }\n        this.dragging.style.right = this.subElements.progress.style.right = newRight + '%';\n        this.subElements.to.innerHTML = this.formatValue(this.getValue().to);\n      }\n    };\n\n    onThumbPointerUp = () => {\n      this.element.classList.remove('range-slider_dragging');\n\n      document.removeEventListener('pointermove', this.onThumbPointerMove);\n      document.removeEventListener('pointerup', this.onThumbPointerUp);\n\n      this.element.dispatchEvent(new CustomEvent('range-select', {\n        detail: this.getValue(),\n        bubbles: true\n      }));\n    };\n\n    constructor({\n      min = 100,\n      max = 200,\n      formatValue = value => '$' + value,\n      selected = {\n        from: min,\n        to: max\n      }\n    } = {}) {\n      this.min = min;\n      this.max = max;\n      this.formatValue = formatValue;\n      this.selected = selected;\n\n      this.render();\n    }\n\n    get template() {\n      const { from, to } = this.selected;\n\n      return `<div class=\"range-slider\">\n        <span data-element=\"from\">${this.formatValue(from)}</span>\n        <div data-element=\"inner\" class=\"range-slider__inner\">\n          <span data-element=\"progress\" class=\"range-slider__progress\"></span>\n          <span data-element=\"thumbLeft\" class=\"range-slider__thumb-left\"></span>\n          <span data-element=\"thumbRight\" class=\"range-slider__thumb-right\"></span>\n        </div>\n        <span data-element=\"to\">${this.formatValue(to)}</span>\n      </div>`;\n    }\n\n    render() {\n      const element = document.createElement('div');\n\n      element.innerHTML = this.template;\n\n      this.element = element.firstElementChild;\n      this.element.ondragstart = () => false;\n\n      this.subElements = this.getSubElements(element);\n\n      this.initEventListeners();\n\n      this.update();\n    }\n\n    initEventListeners() {\n      const { thumbLeft, thumbRight } = this.subElements;\n\n      thumbLeft.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n      thumbRight.addEventListener('pointerdown', event => this.onThumbPointerDown(event));\n    }\n\n    getSubElements(element) {\n      const result = {};\n      const elements = element.querySelectorAll('[data-element]');\n\n      for (const subElement of elements) {\n        const name = subElement.dataset.element;\n\n        result[name] = subElement;\n      }\n\n      return result;\n    }\n\n    remove() {\n      if (this.element) this.element.remove();\n      this.element.remove();\n    }\n\n    destroy() {\n      this.remove();\n      document.removeEventListener('pointermove', this.onThumbPointerMove);\n      document.removeEventListener('pointerup', this.onThumbPointerUp);\n    }\n\n    update() {\n      const rangeTotal = this.max - this.min;\n      const left = Math.floor((this.selected.from - this.min) / rangeTotal * 100) + '%';\n      const right = Math.floor((this.max - this.selected.to) / rangeTotal * 100) + '%';\n\n      this.subElements.progress.style.left = left;\n      this.subElements.progress.style.right = right;\n\n      this.subElements.thumbLeft.style.left = left;\n      this.subElements.thumbRight.style.right = right;\n    }\n\n    onThumbPointerDown(event) {\n      const thumbElem = event.target;\n\n      event.preventDefault();\n\n      const { left, right } = thumbElem.getBoundingClientRect();\n\n      if (thumbElem === this.subElements.thumbLeft) {\n        this.shiftX = right - event.clientX;\n      } else {\n        this.shiftX = left - event.clientX;\n      }\n\n      this.dragging = thumbElem;\n\n      this.element.classList.add('range-slider_dragging');\n\n      document.addEventListener('pointermove', this.onThumbPointerMove);\n      document.addEventListener('pointerup', this.onThumbPointerUp);\n    }\n\n    getValue() {\n      const rangeTotal = this.max - this.min;\n      const { left } = this.subElements.thumbLeft.style;\n      const { right } = this.subElements.thumbRight.style;\n\n      const from = Math.round(this.min + parseFloat(left) * 0.01 * rangeTotal);\n      const to = Math.round(this.max - parseFloat(right) * 0.01 * rangeTotal);\n\n      return { from, to };\n    }\n  }\n","const header = [\n  {\n    id: 'images',\n    title: 'Image',\n    sortable: false,\n    template: data => {\n      if (data.length) {\n        return `\n        <div class=\"sortable-table__cell\">\n          <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\n        </div>\n      `;\n      } else {\n        return `\n        <div class=\"sortable-table__cell\">\n          <img class=\"sortable-table-image\" alt=\"Image\" src=\"https://via.placeholder.com/100\">\n        </div>\n      `;\n      }\n    }\n  },\n  {\n    id: 'title',\n    title: 'Name',\n    sortable: true,\n    sortType: 'string'\n  },\n  {\n    id: 'subcategory',\n    title: 'Category',\n    sortable: false,\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n          ${data.title}\n        </div>`;\n    }\n  },\n  {\n    id: 'quantity',\n    title: 'Quantity',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'price',\n    title: 'Price',\n    sortable: true,\n    sortType: 'number'\n  },\n  {\n    id: 'status',\n    title: 'Status',\n    sortable: true,\n    sortType: 'number',\n    template: data => {\n      return `<div class=\"sortable-table__cell\">\n          ${data > 0 ? 'Active' : 'Inactive'}\n        </div>`;\n    }\n  },\n];\n\nexport default header;\n","import SortableTable from '~components/sortable-table/index.js';\nimport RangeSlider from '~components/double-slider/index.js';\nimport header from './products-header.js';\n\nexport default class Page {\n  components = {};\n  priceMin = 0;\n  priceMax = 5000;\n  priceFrom = this.priceMin;\n  priceTo = this.priceMax;\n  status;\n  titleLike;\n  timer;\n\n  onChangeRange = event => {\n    this.priceFrom = event.detail.from;\n    this.priceTo = event.detail.to;\n    this.updateSortableTable();\n  };\n\n  onChangeStatus = event => {\n    const value = Number(event.target.value);\n    if (value >= 0) this.status = value;\n    else this.status = null;\n    this.updateSortableTable();\n  };\n\n  onInputTitle = event => {\n    clearTimeout(this.timer);\n    this.timer = setTimeout(() => {\n      this.titleLike = event.target.value;\n      this.updateSortableTable();\n    }, 1000);\n  };\n\n  onFilterReset = event => {\n    if (!event.target.closest('[data-element=\"resetFilterBtn\"]')) return;\n    this.subElements.filterStatus.value = -1;\n    this.status = null;\n\n    this.subElements.filterName.value = '';\n    this.titleLike = '';\n\n    this.updateRangeSlider();\n    this.priceFrom = this.priceMin;\n    this.priceTo = this.priceMax;\n\n    this.updateSortableTable();\n  };\n\n  render() {\n    this.initComponents();\n    this.element = this.toHTML(this.getTemplate());\n    this.renderComponents();\n    this.subElements = this.getSubElements(this.element);\n    this.addEventListeners();\n    return this.element;\n  }\n\n  getTemplate() {\n    return `\n    <div class=\"products-list\">\n      <div class=\"content__top-panel\">\n        <h1 class=\"page-title\">Товары</h1>\n        <a href=\"/products/add\" class=\"button-primary\">Добавить товар</a>\n      </div>\n      <div class=\"content-box content-box_small\">\n        <form class=\"form-inline\">\n          <div class=\"form-group\">\n            <label class=\"form-label\">Сортировать по:</label>\n            <input\n              type=\"text\"\n              data-element=\"filterName\"\n              class=\"form-control\"\n              placeholder=\"Название товара\"\n            />\n          </div>\n          <div class=\"form-group\" data-elem=\"sliderContainer\">\n            <label class=\"form-label\">Цена:</label>\n            <div data-rangeSlider>\n            </div>\n          </div>\n          <div class=\"form-group\">\n            <label class=\"form-label\">Статус:</label>\n            <select class=\"form-control\" data-element=\"filterStatus\">\n              <option value=\"-1\" selected=\"\">Любой</option>\n              <option value=\"1\">Активный</option>\n              <option value=\"0\">Неактивный</option>\n            </select>\n          </div>\n        </form>\n      </div>\n      <div data-elem=\"productsContainer\" class=\"products-list__container\">\n        <div data-sortableTable>\n        </div>\n      </div>\n    </div>\n    `;\n  }\n\n  initComponents() {\n    const rangeSlider = this.initRangeSlider();\n    const sortableTable = this.initSortableTable();\n\n    this.components = {\n      rangeSlider,\n      sortableTable\n    };\n  }\n\n  initSortableTable(\n    price_gte = this.priceFrom,\n    price_lte = this.priceTo,\n    status = this.status,\n    titleLike = this.titleLike\n  ) {\n    const productsUrl = new URL('api/rest/products', process.env.BACKEND_URL);\n    productsUrl.searchParams.set('_embed', 'subcategory.category');\n    if (price_gte) productsUrl.searchParams.set('price_gte', price_gte);\n    if (price_lte) productsUrl.searchParams.set('price_lte', price_lte);\n    if (status || status === 0) productsUrl.searchParams.set('status', status);\n    if (titleLike) productsUrl.searchParams.set('title_like', titleLike);\n    const sortableTable = new SortableTable(header, {\n      url: productsUrl.toString(),\n      rowTemplate: (content, dataItem) => `<a href=\"/products/${dataItem.id}\" class=\"sortable-table__row\">${content}</a>`,\n      sorted: {\n        id: 'title',\n        order: 'asc'\n      }\n    });\n    sortableTable.element.dataset.element = 'sortableTable';\n\n    return sortableTable;\n  }\n\n  initRangeSlider() {\n    const rangeSlider = new RangeSlider({ min: this.priceMin, max: this.priceMax });\n    rangeSlider.element.dataset.element = 'rangeSlider';\n    return rangeSlider;\n  }\n\n  renderComponents() {\n    for (const component of Object.entries(this.components)) {\n      this.element.querySelector(`[data-${component[0]}]`).replaceWith(component[1].element);\n    }\n  }\n\n  updateSortableTable() {\n    const sortableTable = this.initSortableTable();\n    this.subElements.sortableTable.replaceWith(sortableTable.element);\n    this.subElements.sortableTable = sortableTable.element;\n    this.components.sortableTable.destroy();\n    this.components.sortableTable = sortableTable;\n  }\n\n  updateRangeSlider() {\n    const rangeSlider = this.initRangeSlider();\n    this.subElements.rangeSlider.replaceWith(rangeSlider.element);\n    this.subElements.rangeSlider = rangeSlider.element;\n    this.components.rangeSlider.destroy();\n    this.components.rangeSlider = rangeSlider;\n  }\n\n  getSubElements(root) {\n    const subElements = {};\n    [...root.querySelectorAll('[data-element]')].forEach(el => {\n      subElements[el.dataset.element] = el;\n    });\n    return subElements;\n  }\n\n  addEventListeners() {\n    document.addEventListener('range-select', this.onChangeRange);\n    this.subElements.filterStatus.addEventListener('change', this.onChangeStatus);\n    this.subElements.filterName.addEventListener('input', this.onInputTitle);\n    document.addEventListener('pointerup', this.onFilterReset);\n  }\n\n  removeEventListeners() {\n    document.removeEventListener('range-select', this.onChangeRange);\n    document.removeEventListener('pointerup', this.onFilterReset);\n  }\n\n  remove() {\n    if (this.element) this.element.remove();\n    this.element = null;\n  }\n\n  destroy() {\n    this.remove();\n    this.removeEventListeners();\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n\n  toHTML(htmlString) {\n    const htmlObject = document.createElement('div');\n    htmlObject.innerHTML = htmlString;\n    return htmlObject.firstElementChild;\n  }\n}\n"],"sourceRoot":""}